---
title: "p8105_hw2_zz2780"
author: "Lydia Zhang"
date: "2022-10-01"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
```
Problem 1

Import data
```{r}
data1<-read_csv("data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv",
                col_types = cols(Route8 = "c", Route9 = "c", Route10 = "c", Route11 = "c")) %>% 
  janitor::clean_names() %>% 
  select(
    line, station_name, station_latitude, station_longitude, 
    starts_with("route"), entry, exit_only, vending, entrance_type, 
    ada) %>% 
  mutate(entry = ifelse(entry == "YES", TRUE, FALSE))
```
The data is not tidy. I imported the data, selected variables of interest, and converted entry variable from character to logic. The data set origianlly has 1868 rows (observations) and 20 variables(columns). Route number should be a variable and the values should be another variable. We need to pivot the two variables from wider to longer format.

How many distinct stations are there?
```{r}
data1 %>% 
  filter(ada == TRUE) %>% 
  select(station_name, line) %>% 
  distinct
```
There are 84 distinct stations.

How many stations are ADA compliant?
```{r}
data1 %>% 
  filter(ada == TRUE) %>% 
  select(station_name, line) %>% 
  distinct
```
84 stations are ADA compliant.

What proportion of station entrances / exits without vending allow entrance?
```{r}
data1 %>% 
  filter(vending == "NO") %>% 
  pull(entry) %>% 
  mean
```
37.7% of the station entrances/exists are without vending allow entrance.

Reformat data so that route number and route name are distinct variables. How many distinct stations serve the A train? Of the stations that serve the A train, how many are ADA compliant?

```{r}
data1 %>% 
  pivot_longer(
    route1:route11,
    names_to = "route_num",
    values_to = "route") %>% 
  filter(route == "A") %>% 
  select(station_name, line) %>% 
  distinct

data1 %>% 
  pivot_longer(
    route1:route11,
    names_to = "route_num",
    values_to = "route") %>% 
  filter(route == "A", ada == TRUE) %>% 
  select(station_name, line) %>% 
  distinct
```
60 distinct stations serve A train. And of those 17 are ADA compliant.


Problem 2
```{r}
library(readxl)
```

Tidy Mr.Trash Wheel
```{r}
data2=read_excel("data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", sheet="Mr. Trash Wheel", range="A2:N535")%>%
    janitor::clean_names() %>% 
  na.omit()
data2$sports_balls<-as.integer(data2$sports_balls)
data2$dumpster<-as.numeric(data2$dumpster)
```

Tidy Professor Trash Wheel
```{r}
data2_1=read_excel("data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", sheet="Professor Trash Wheel", range="A2:N117")%>%
    janitor::clean_names() %>% 
  na.omit()
data2_1$sports_balls<-as.integer(data2_1$sports_balls)
```

Combine two data sets
```{r}
data2$type<-"Mr. Trash Wheel"
data2<-data2%>%relocate(type, .after=dumpster)
data2_1$type<-"Professor Trash Wheel"
data2_1<-data2_1%>%relocate(type, .after=dumpster)
data2_tidy=
  bind_rows(data2, data2_1)%>%
  janitor::clean_names() %>%
  arrange(dumpster,type)
```

The resulting data set contains `r nrow(data2_tidy)` observations and `r ncol(data2_tidy)` variables. Type indicates which trash wheel is used. The data set includes how many weights (ton) and volume (cubic yard) each trash wheel collected on each date at different dumpsters. And it records the number of different types of trash that were picked up, as well as the number of homes it can power.

What was the total weight of trash collected by Professor Trash Wheel? 
```{r}
data2_tidy%>%
  filter(type=="Professor Trash Wheel")%>%
  pull(weight_tons)%>%
sum
```
The total weight of trash collected by Professor Trash Wheel was 135.5 tons.

What was the total number of sports balls collected by Mr. Trash Wheel in 2020?
```{r}
data2_tidy%>%
  filter(type=="Mr. Trash Wheel", year==2020)%>%
  pull(sports_balls)%>%
sum
```
856 sports balls were collected by Mr. Trash Wheel in 2020.



